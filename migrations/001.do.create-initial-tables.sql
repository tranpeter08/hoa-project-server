CREATE TABLE users
(
  id INT PRIMARY KEY GENERATED ALWAYS AS IDENTITY,
  username TEXT UNIQUE NOT NULL, 
  user_pw TEXT NOT NULL,
  is_admin BOOL DEFAULT false NOT NULL 
);

CREATE TABLE units
(
  id INT PRIMARY KEY GENERATED ALWAYS AS IDENTITY,
  unit_num INT UNIQUE NOT NULL
);

CREATE TABLE residents
(
  id INT PRIMARY KEY GENERATED ALWAYS AS IDENTITY,
  email TEXT NOT NULL,
  phone TEXT NOT NULL,
  first_name TEXT NOT NULL,
  last_name TEXT NOT NULL,
  balance NUMERIC NOT NULL DEFAULT 0.00,
  user_id INT REFERENCES users(id) ON DELETE CASCADE UNIQUE NOT NULL,
  unit_id INT REFERENCES units(id) UNIQUE NOT NULL
);

CREATE TABLE payments
(
  id INT PRIMARY KEY GENERATED ALWAYS AS IDENTITY,
  payment NUMERIC NOT NULL,
  end_balance NUMERIC NOT NULL,
  notes TEXT,
  trans_date TIMESTAMPTZ DEFAULT now() NOT NULL,
  user_id INT REFERENCES users(id) ON DELETE CASCADE NOT NULL
);

CREATE TABLE user_payments
(
  user_id INT REFERENCES users(id) ON DELETE CASCADE NOT NULL,
  payment_id INT REFERENCES payments(id) ON DELETE CASCADE NOT NULL
);